#define ESC 27
#define ENTER_KEY 13
#define UP_KEY 20
#define DOWN_KEY 21
#define RIGHT_KEY 22 
#define LEFT_KEY 23
long aaa;
char pic1[]={1,0,1,16,16,32,8,4,67,200,36,32,8,16,11,208,9,144,5,160,3,192};
char pic2[]={0,0,0,0,0,0,0,0,3,192,7,224,15,240,12,48,14,112,6,96,3,192};
int guang[1300]={
0,0,1,0,0,0,1,0,1,0,1,0,0,0,1,0,1,0,1,0,0,0,1,0,0,
1,0,1,0,1,0,0,1,0,0,1,0,1,0,1,0,1,0,1,0,0,1,0,1,0,
0,1,1,1,0,0,0,1,0,0,1,1,0,1,1,0,1,0,1,1,0,1,0,0,1,
0,0,1,0,0,1,1,1,1,1,0,0,1,0,0,1,1,1,1,0,0,0,1,1,1,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
1,1,1,0,0,1,1,1,0,0,1,1,1,1,1,0,0,1,1,1,0,0,1,1,1,
1,1,1,1,1,1,0,0,0,1,0,0,0,0,0,1,0,0,0,1,1,1,1,1,1,
1,1,1,1,1,1,0,0,0,1,1,0,0,0,1,1,0,0,0,1,1,1,1,1,1,
0,0,1,0,0,0,0,1,0,0,1,1,1,1,1,0,0,1,0,0,0,0,1,0,0,
0,0,0,0,0,1,0,0,0,1,1,1,0,1,1,1,0,0,0,1,0,0,0,0,0,
0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,0,1,1,1,0,0,0,0,0,0,
1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,
0,1,1,1,0,1,0,1,0,1,1,1,0,1,1,1,0,1,0,1,0,1,1,1,0,
0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,
0,1,1,1,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,
0,1,0,1,0,1,0,1,0,1,1,1,0,1,1,1,0,1,0,1,0,1,0,1,0,
0,0,0,1,0,0,0,0,1,0,1,1,1,1,1,0,1,0,0,0,0,1,0,0,0,
0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,
0,0,0,0,0,0,1,1,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,0,1,1,1,0,0,
0,0,0,1,0,0,0,0,1,1,0,0,0,1,1,0,0,0,1,1,0,0,0,1,0,
0,0,0,0,0,1,1,0,1,1,1,1,0,1,1,1,1,0,1,1,0,0,0,0,0,
1,1,1,1,1,1,0,0,1,1,1,0,0,0,1,1,1,0,0,1,1,1,1,1,1,
1,1,1,0,0,1,1,0,0,0,1,1,0,1,1,0,0,0,1,1,0,0,1,1,1,
1,1,1,0,0,0,0,1,0,0,0,0,1,1,1,0,0,1,1,1,0,0,1,0,0,
0,1,1,1,0,1,0,0,0,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,0,
0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,
1,1,0,1,1,0,1,1,0,1,1,0,0,0,0,0,1,1,1,1,0,0,1,0,1,
1,1,1,1,0,1,1,1,0,0,1,1,0,1,0,1,0,1,1,0,0,0,0,0,0,
0,0,1,0,0,1,0,1,0,1,0,0,0,0,0,0,0,1,0,0,0,1,1,1,0,
1,0,0,1,1,1,0,0,1,0,1,0,1,1,0,0,0,1,1,1,0,0,0,0,1,
1,1,1,1,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,1,0,1,1,0,1,
0,1,0,0,0,1,1,0,1,0,1,1,1,1,1,0,0,0,0,1,0,0,1,0,1,
0,0,1,0,0,1,0,1,0,0,1,1,1,0,1,0,0,1,1,1,0,0,0,0,1,
0,0,0,0,0,1,1,1,0,1,1,0,1,0,0,0,0,0,1,0,0,1,0,1,1,
1,1,1,0,0,0,1,0,0,1,1,1,0,1,1,1,0,0,0,0,0,1,1,0,1,
1,1,1,1,0,1,1,0,0,0,0,0,1,1,0,0,0,0,1,1,1,1,0,1,1,
1,1,0,0,0,0,1,0,0,0,0,0,0,1,1,1,1,0,1,1,0,0,1,0,0,
1,0,0,0,0,1,1,0,0,0,1,1,0,0,0,0,0,0,0,1,1,1,1,0,1,
0,0,0,0,0,0,1,1,1,1,1,0,1,1,0,1,1,1,0,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,1,1,1,1,0,1,1,1,0,0,0,1,1,0,1,1,0,
1,1,1,1,1,1,1,1,0,1,0,0,1,0,0,1,0,0,1,1,0,0,0,0,0,
1,1,1,0,0,1,0,0,1,1,1,0,1,1,1,0,0,0,0,1,0,0,0,0,1,
1,1,1,0,1,0,0,0,0,0,1,1,1,1,1,1,1,0,1,1,0,0,0,0,1,
1,0,1,0,1,1,1,1,0,1,1,0,1,0,1,1,1,0,1,1,1,0,0,0,1,
0,1,1,0,1,1,1,1,1,0,1,0,1,1,1,1,1,1,1,1,0,1,0,1,1,
0,0,1,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,0,1,0,0,0,0,0,
0,0,0,0,0,1,1,0,1,1,1,0,0,1,1,1,1,0,0,1,0,0,0,1,0,
0,1,0,1,0,0,1,0,1,1,1,1,1,0,0,1,0,1,0,1,0,1,1,0,1,
1,0,1,0,1,0,1,1,0,1,1,0,0,0,0,0,1,0,1,1,1,0,0,1,1,
0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,1,0,0,0,1,1,1,0,1,1};

int qu[5][5];
int kx,ky,move,guangka;
char ch,moves[6],gguan[6];

int check()
{
int i,j,k;

k=0;
for(i=0;i<5;i++)
{
for(j=0;j<5;j++){if(qu[i][j]==1)k=k+1;}
}
if(k==25)return 1;
return 0;
}

void change(int x,int y)
{
if(x<0||y<0||y>4||x>4)return;
if(qu[x][y]==0){qu[x][y]=1;WriteBlock(10+y*17,10+x*12,16,11,102,pic2);}
else {qu[x][y]=0;WriteBlock(10+y*17,10+x*12,16,11,102,pic1);}
}

void show()
{
int i,j,x,y;

for(i=0;i<5;i++)
{
y=10+i*12;
for(j=0;j<5;j++)
{
x=10+j*17;
if(qu[i][j]==0){WriteBlock(x,y,16,11,102,pic1);}
else {WriteBlock(x,y,16,11,102,pic2);}
}
}
}

void select()
{
int i,j,x,y;

guangka=0;
aaaa:
for(i=0;i<5;i++)
{
for(j=0;j<5;j++){qu[i][j]=guang[guangka*25+i*5+j];}
}
show();
TextOut(110,12,"第   关",102);
sprintf(gguan,"%d",guangka+1);
if(guangka+1<10)TextOut(128,12,gguan,102);
else TextOut(125,12,gguan,102);
ch=getchar();
if(ch==ENTER_KEY)return;
if(ch==ESC)
{
	Box(41,32,114,58,1,0);
	Box(41,32,114,58,0,1);
	TextOut(42,34,"你要离开吗？",102);
	TextOut(42,46,"   (Y/N)    ",102);
	ch=getchar();
	if(ch=='y'){exit(0);}
	Box(0,0,160,80,1,0);
	for(i=0;i<5;i++)
	{
	y=9+i*12;
	for(j=0;j<5;j++)
	{
	x=9+j*17;
	Box(x,y,x+17,y+12,0,1);
	}
	}
}
if(ch==UP_KEY)
{
guangka=guangka-1;
if(guangka<0)guangka=51;
}
if(ch==DOWN_KEY)
{
guangka=guangka+1;
if(guangka>51)guangka=0;
}
goto aaaa;
}

void main()
{
int i,j,x,y;

Box(0,0,160,80,1,0);
for(i=0;i<5;i++)
{
y=9+i*12;
for(j=0;j<5;j++)
{
x=9+j*17;
Box(x,y,x+17,y+12,0,1);
}
}
for(i=0;i<5;i++)
{
for(j=0;j<5;j++){qu[i][j]=1;}
}
select();
newgame:
show();
TextOut(102,30,"moves:    ",102);
sprintf(moves,"%d",move);
TextOut(140,30,moves,102);
for(;;)
{
Box(10+ky*17,10+kx*12,25+ky*17,20+kx*12,1,2);
ch=getchar();
Box(10+ky*17,10+kx*12,25+ky*17,20+kx*12,1,2);
if(ch==ESC)break;
if(ch==ENTER_KEY)
{
	move=move+1;
	TextOut(102,30,"moves:    ",102);
	sprintf(moves,"%d",move);
	TextOut(140,30,moves,102);
	change(kx-1,ky);
	change(kx,ky);
	change(kx+1,ky);
	change(kx,ky-1);
	change(kx,ky+1);
	if(check()==1)break;
	continue;
}
if(ch==UP_KEY&&kx>0){kx=kx-1;continue;}
if(ch==DOWN_KEY&&kx<4){kx=kx+1;continue;}
if(ch==LEFT_KEY&&ky>0){ky=ky-1;continue;}
if(ch==RIGHT_KEY&&ky<4){ky=ky+1;continue;}
}
if(ch==ESC)
{
	Box(41,32,114,58,1,0);
	Box(41,32,114,58,0,1);
	TextOut(42,34,"你要离开吗？",102);
	TextOut(42,46,"   (Y/N)    ",102);
	ch=getchar();
	if(ch=='y'){exit(0);}
}
else
{
TextOut(42,34,"Good Job!",199);
getchar();
move=0;
kx=0;
ky=0;
guangka=guangka+1;
if(guangka>51)guangka=0;
for(i=0;i<5;i++)
{
for(j=0;j<5;j++){qu[i][j]=guang[guangka*25+i*5+j];}
}
}
Box(0,0,160,80,1,0);
TextOut(110,12,"第   关",102);
sprintf(gguan,"%d",guangka+1);
if(guangka+1<10)TextOut(128,12,gguan,102);
else TextOut(125,12,gguan,102);
for(i=0;i<5;i++)
{
y=9+i*12;
for(j=0;j<5;j++)
{
x=9+j*17;
Box(x,y,x+17,y+12,0,1);
}
}
goto newgame;
}