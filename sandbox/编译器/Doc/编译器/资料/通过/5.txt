#define KEY_ESC 0x1b//退出
#define KEY_PGUP 0x69//上翻页-->I
#define KEY_PGDWN 0x6b//下翻页-->K
//b16格式的文件头20字节
long aaa;
char fdir[]="/bmp16";
char head[3];
char stmp[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x07,0x00,0x01,0x80,0x30,0x00,0x70,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x07,0xC0,0x03,0xC0,0x78,0x00,0xF9,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x07,0xC0,0x03,0xE0,0x78,0x00,0xFF,0xE0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x0F,0xC0,0x03,0xE0,0xF0,0x00,0xFF,0xF0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x0F,0xC0,0x03,0xE0,0xF0,0x00,0xFF,0xF8,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x0F,0xC0,0x03,0xE1,0xF0,0x00,0xF8,0xF8,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x0F,0x80,0x07,0xE1,0xE0,0x01,0xF8,0xF8,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x0F,0x80,0x07,0xC1,0xE0,0x01,0xF0,0xF0,0xE0,0x00,0x3E,0x03,0x80,0x00,0x1F,0x80,
0x1F,0x00,0xF0,0x00,
0x0F,0xFE,0x07,0xC3,0xFF,0x01,0xF1,0xF0,0xF0,0xE0,0x7F,0x87,0xC3,0x00,0x7F,0xC0,
0x7F,0xC0,0xF8,0xF0,
0x1F,0xFF,0x07,0xC3,0xFF,0xC1,0xE3,0xE1,0xFF,0xF0,0xFF,0xC7,0xC7,0x00,0x7F,0xE0,
0xFF,0xE0,0xFF,0xF0,
0x1F,0x8F,0x07,0x83,0xFF,0xE1,0xE7,0xC1,0xFF,0xE1,0xF3,0xC7,0xCF,0x1C,0xFF,0xF0,
0xF9,0xF0,0xFF,0xF0,
0x1F,0x0F,0x07,0x83,0xF1,0xE1,0xEF,0xE1,0xFF,0x81,0xC3,0xC3,0xCF,0x1C,0xF1,0xF1,
0xE0,0xF0,0xFF,0x80,
0x1E,0x0F,0x07,0x83,0xE0,0xE1,0xFF,0xE1,0xFE,0x01,0xC3,0xC3,0xDF,0x38,0xF1,0xF1,
0xF0,0xF8,0xFE,0x00,
0x1E,0x0F,0x07,0x03,0xC0,0xE3,0xFE,0xE1,0xF8,0x03,0x83,0xC3,0xDF,0x70,0x78,0xE1,
0xFE,0xF8,0xFC,0x00,
0x1E,0x0F,0x0F,0x03,0xC1,0xE1,0xC0,0xE1,0xF0,0x03,0x87,0xC3,0xFF,0x70,0x3E,0x01,
0xFF,0xF1,0xF0,0x00,
0x1E,0x1F,0x0F,0x03,0xE1,0xE1,0xC1,0xE1,0xE0,0x03,0x87,0x81,0xFF,0xE0,0x1F,0x81,
0xFF,0xF1,0xE0,0x00,
0x1E,0x3E,0x0E,0x03,0xE3,0xE1,0xC1,0xC1,0xC0,0x03,0x8F,0x81,0xFF,0xE0,0x03,0xC1,
0xE3,0xE1,0xE0,0x00,
0x1E,0x7C,0x0E,0x01,0xFF,0xC1,0xC7,0xC1,0xC0,0x03,0xFF,0x01,0xFB,0xE0,0x71,0xC0,
0xF0,0x01,0xC0,0x00,
0x1F,0xF8,0x0E,0x01,0xFF,0x81,0xFF,0x01,0x80,0x03,0xFE,0x00,0xF3,0xC0,0x7F,0xC0,
0xFF,0xC1,0xC0,0x00,
0x1F,0xF0,0x0C,0x00,0xFF,0x01,0xBE,0x01,0x80,0x01,0xFC,0x00,0xF3,0xC0,0x3F,0x80,
0x3F,0xC1,0x80,0x00,
0x0F,0x80,0x00,0x00,0x3C,0x00,0x80,0x01,0x00,0x00,0xF0,0x00,0x61,0x80,0x1F,0x00,
0x07,0x81,0x80,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x60,0x00,0x00,0x00,0x00,0x00,0x03,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0xF0,0x00,0x00,0x00,0x00,0x00,0x03,0x80,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0xF0,0x00,0x00,0x00,0x00,0x00,0x03,0x80,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0xF0,0x00,0x00,0x00,0x00,0x00,0x07,0x80,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x01,0xF0,0x00,0x01,0x80,0x00,0x00,0x07,0x80,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x01,0xFC,0x38,0x03,0xC6,0x01,0xC0,0x07,0x9C,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x01,0xFF,0x3C,0x73,0xC7,0x79,0xC6,0x07,0xFC,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x01,0xF7,0x3C,0xF1,0xC7,0xF9,0xCE,0x67,0xFC,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x01,0xC7,0x3C,0xF0,0x07,0xE1,0xFE,0xE7,0xF8,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x01,0xC7,0x1D,0xE0,0x0F,0xC0,0xFE,0xC7,0xF0,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x01,0xC7,0x1F,0xC0,0x0F,0x00,0xFF,0x86,0x70,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x01,0xCF,0x0F,0xC3,0x8E,0x00,0xFF,0x86,0x70,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x01,0x9E,0x07,0x83,0xCE,0x00,0xF7,0x86,0x30,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x01,0xFC,0x07,0x87,0xCC,0x00,0x77,0x0C,0x38,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x01,0xF0,0x07,0x03,0x8C,0x00,0x63,0x04,0x18,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x1E,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x1C,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00};
char fp;
char b16name[30];
void display()
{char i,key,fpset,itemset,maxfp;
 int fpoffset;
 long flenth;
 fpset=1;fp=fopen(b16name,"r");
 if(fp==NULL){SetScreen(0);printf("打开文件失败!");getchar();exit(0);}
 fread(head,1,3,fp);
 fseek(fp,0,SEEK_END);
 flenth=ftell(fp);
 if(strcmp(head,"b16")){itemset=15;fpoffset=0x5dc0;maxfp=(flenth-20)/fpoffset;} 
 else{itemset=7;fpoffset=0x2bc0;maxfp=flenth/fpoffset;}
 printf("共有%d幅图片\n按任意键开始浏览\nI 上翻  K 下翻\n跳出 退出",maxfp);getchar();
 for(;;)
  {if(itemset==15)fseek(fp,20+(fpset-1)*fpoffset,SEEK_SET);
   else fseek(fp,(fpset-1)*fpoffset,SEEK_SET);   
   for(i=0;i<itemset;i++){fread(stmp,1,1600,fp);memcpy(_GRAPH,stmp,1600);}
   key=Inkey();
   if(key==KEY_ESC)break;
   if(key==KEY_PGUP){fpset--;if(fpset<1)fpset=1;}
   if(key==KEY_PGDWN){fpset++;if(fpset>maxfp)fpset=maxfp;}
  }
 fclose(fp);
}
void main()
{SetScreen(0);
 WriteBlock(0,0,160,80,1,stmp);Refresh();getchar();
 if(!ChDir(fdir))
  {printf("没有b16目录!\n按任意键创建目录!");getchar();
   MakeDir(fdir);if(!ChDir(fdir)){SetScreen(0);printf("创建目录失败!");getchar();exit(0);}
  }
 for(;;)
  {if(!FileList(b16name))break;
   if(!strcmp(b16name,".."))
   continue;
   display();
  }
 SetScreen(0);printf("rwk制作 谢谢使用!");getchar();
}